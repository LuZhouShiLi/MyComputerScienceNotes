# 认识微服务


## 单体架构

![图 0](../images/58a048bf8911222f03111bc9e2b14b16fa91d89be787d88030b1e7eea669a40e.png)  


## 分布式架构


![图 1](../images/c040d30d11e06e12185544c572e3a673fb963c6a9177e5a4164e5187dc612e0e.png)  

## 微服务架构

![图 2](../images/f2801c0837fdbed4ec2d5c78ecf12cd0d36059021678b3acb285cb0c38cd4ca6.png)  


## SpringCloud


![图 3](../images/d4c91f88daa7b3d81d345d50060f310638c7b238fd2379011c7d0e386dda0ed8.png)  


## 服务拆分和注意事项

![图 4](../images/a87b9cb76b5c162582caf19f7f0c30100a1b643cbf395356b413f3f552ccfc57.png)  


### 服务拆分的案例demo

**各个服务之间的数据库都是相互独立的，你不能直接访问对方的数据库，只能从一个服务像另外一个服务发起远程调用**


![图 5](../images/9ef2c83b6541f6787990a291b88c9938d28c59df766910be28bc6c4fbef5360a.png)  

**在订单模块的服务中 发起用户查询的请求**

**在Order-Service模块中入口类注册RestTemplate,使用它来发送http请求**

![图 6](../images/33362b16fa8fc8731a3db4438ef7bb1edf0a53ceba0e2c06da051e6b4b00849e.png)  



**在查询订单的页面中，注入restTemplate变量，然后使用它发送http请求，查询用户**

```java
 public Order queryOrderById(Long orderId) {
        // 1.查询订单
        Order order = orderMapper.findById(orderId);

        // 创建url
        String url = "http://localhost:8081/user/" + order.getUserId();

        // 发哦是那个http请求  实现远程调用
        User user = restTemplate.getForObject(url,User.class);

        // 封装user到Order
        order.setUser(user);

        // 返回user
        return order;


        // 4.返回
//        return order;
    }

```



## 服务者和消费者

![图 7](../images/0b0e6176d6a7ac63bcad97c00d24fd61ccfbd8e0da2e848cd3123d297ce1ec57.png)  


