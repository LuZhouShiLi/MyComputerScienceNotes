# 触发器

## 概述

![图 1](../../images/14c9b9cc98a61c69632e453bbe075a197e5f20616a65d961d4a7e844bb05cde0.png)  

![图 2](../../images/146b3d8760ab695ef7f697d5145028f8f5a6b888dfedf8aa81d2815b2877c7fc.png)  

## INSERT触发器

![图 3](../../images/076895002653951f46ef7e491713b83faabb7b5fdd9c535f1aefe788554183a5.png)  

```sql
-- 创建INSERT触发器  用于对account表新增数据进行日志记录
DELIMITER $

CREATE TRIGGER account_insert
AFTER INSERT
ON account
FOR EACH ROW

BEGIN 

	INSERT INTO account_log VALUES (NULL,'INSERT',NOW(),new.id,CONCAT('插入后{id=',new.id,',name=',new.name,',money=',new.money,'}'));

END $
DELIMITER ;

```
## UPDATE触发器

```sql
DELIMITER $
CREATE TRIGGER account_update
AFTER UPDATE
ON account
FOR EACH ROW

BEGIN
	INSERT INTO account_log VALUES (NULL,'UPDATE',NOW(),new.id,CONCAT('更新后{id=',new.id,',name=',new.name,',money=',new.money,'}'));

END $
DELIMITER ;

```


## DELETE型触发器

```sql

DELIMITER $

CREATE TRIGGER account_delete
AFTER DELETE
ON account
FOR EACH ROW
BEGIN 

	INSERT INTO account_log VALUES (NULL,'DELETE',NOW(),old.id,CONCAT('删除之前的数据{id=',old.id,',name=',old.name,',money=',old.money,'}'));

END $
DELIMITER ;

```


## 查看和删除触发器

![图 4](../../images/4afa1ced8df761d203e5c69a0756a1a3f1919e2cf1510ed0100d31b0daebe569.png)  

```sql
-- 查看触发器
SHOW TRIGGERs;


-- 删除触发器
DROP TRIGGER account_delete;

```

